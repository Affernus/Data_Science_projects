# Разработка модели для прогноза рыночной стоимости автомобилей с пробегом

**Задача:** построить модель для определения рыночной стоимости автомобиля; заказчику важны качество предсказания, скорость предсказания, время обучения.

**Данные:** csv-файл, 354368 объектов, 16 признаков

**Библиотеки и навыки:**   `pandas, numpy, math, datetime, collections, ipywidgets, sklearn, catboost, lightgbm, xgboost, category_encoders, matplotlib, seaborn`, предобработка данных (поиск аномалий, очистка, заполнение пропусков), исследовательский анализ, визуализация результатов, машинное обучение.

**Результаты:**

Входные данные проекта - довольно загрязнённые данные, похоже, с двух площадок, содержащие информацию о продажах авто в Германии. Выполнил очистку данных. Выявил, что данные содержат нули в тех признаках, где их быть не может. Сделал вывод, что нулями заполнены отсутствующие значения. Заполнил их обратно np.nan, чтобы потом подобрать методы обработки и заполнения пропусков. В данных были аномально низкие цены на автомобили, автомобили "моложе", чем дата подачи объявления о продажи, автомобили с возрастом в 1000 лет, автомобили с аномально высокой мощностью двигателя, автомобили первого года с аномально высокими пробегами. Пробеги подозрительно распределены (дискретно). Нашёл rover'ы, которые на самом деле land_rover'ы. Нашёл автомобили, которые ездят на petrol и gasoline, хотя и то и то - бензин (и эти категории значимо отличаются по средней цене авто и по распределению цены). Часть подозрительных объектов удалил, в части - заполнил подозрительные признаки np.nan.

Попробовал заполнить пропуски на основании других данных объекта. Допустим, по сочетанию *модель-бренд-год выпуска* определить наиболее подходящий тип кузова. Попробовал кодировать признаки с большим числом категорий, заменяя категории на стандартизованное среднее значение цены авто для этой категории в тренировочной выборке. Для указанных операций написал 2 класса: DictionaryEncoder и DictionaryImputer

Сгенерировал параметры "возраст автомобиля в годах", "возраст автомобиля в месяцах", "почтовая зона", "почтовый регион". В финальном пайплайне из них осталось 2:  'age_in_years', 'post_zone_region'.

Обучил 4 модели: LinearRegression(), XGBoostRegressor(), CatBoostRegressor() и LGBRegressor(). LinearRegression() и XGBoostRegressor() выбыли из-за метрики/времени работы. Из оставшихся выбрал LGBRegressor(), как более быстрый алгоритм с лучшим значением метрики.

Подобрал оптимальный вариант предобработки данных для этой модели. Получилось, что нужно закодировать категориальные признаки TargetEncoder() и далее преобразовать в тип 'category'. Затем передать в модель.

Параметры модели подобрал с помощью поиска по сетке. Написал свою функцию, т.к. функционал GridSearch меня не устроил в данном случае. При подборе параметров учитывал возможное переобучение по разнице между метриками на трейне и валидации.

Написал несколько собственных классов.
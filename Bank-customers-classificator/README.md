# Классификация клиентов банка по их лояльности

**Задача:** построить модель бинарной классификации для прогноза, прекратит клиент пользоваться услугами банка или нет

**Библиотеки и навыки:** `pandas, numpy, collections, random, sklearn, matplotlib, seaborn `, предобработка данных (поиск аномалий, очистка, заполнение пропусков), исследовательский анализ, статистический анализ (перестановочный тест, A/B тестирование) визуализация результатов, машинное обучение.

**Результат:** В работе перед обучением моделей выполнен ручной анализ данных. На  основании этого анализа можно дать заказчику следующую рекомендацию: 

*Есть какая-то проблема с продуктами банка. Все клиенты,  которые пользовались 4 продуктами банка, ушли. Также ушло большинство  (более 80%) из тех, кто пользовался тремя продуктами. Минимальный отток - среди пользователей двух продуктов. Среди пользователей двух продуктов  больше тех, у кого на счёте 0. Вероятно, стоит проанализировать, что за  продукты не устроили ушедших клиентов и почему именно два продукта  пользуются спросом у клиентов без денег на счёте.*

Выявлено, что покинувшие банк клиенты значимо отличаются от  оставшихся почти по всем количественным признакам (кроме оценочной  заработной платы), наиболее явные отличия - в среднем возрасте и балансе на счёте.

Обучены несколько моделей логистической регрессии, решающего дерева и случайного леса. Их качество проверено на валидационной выборке.  Выполнена проверка адекватности (сравнением с константной и случайной  моделью, вычислением ROC AUC). У всех обученных моделей метрики качества выше, модели адекватны.

Рассмотрено влияние различных методов балансировки классов на результат обучения. Использована комбинация с лучшим результатом: `upsampling + class_weight=balanced`. Также при разбиении выборки использовалась стратификация на базе распределения целевого признака `stratify=y`. При настройке моделей кроме гиперпараметров варьировалось число признаков, а также - порог классификации.

Из всех моделей выбрана лучшая по мерам precision, recall и f1. В  данной задаче я предпочитал recall относительно precision, т.к. потеря  уходящего клиента - это, на мой взгляд, хуже, чем ложное срабатывание.  Однако баланс, несомненно, важен, и это учитывалось.
# Прогноз эффективности восстановления золота из золотосодержащей руды

**Задача:**  построить модель для прогноза коэффициента восстановления золота (recovery) из золотосодержащей руды

**Данные:** 3 csv-файла, 5856 - 22716 объектов, 53-87 признаков

**Библиотеки и навыки:**  <code>pandas, numpy, math, sklearn, catboost, xgboost, matplotlib, seaborn</code>, предобработка данных (поиск аномалий, очистка, заполнение пропусков), исследовательский анализ, визуализация результатов, машинное обучение.

Потребовалось глубокое погружение в тему; построил подробную схему обогащения руды (более 80 специальных параметров); обработал и проверил на корректность входные данные с большим количеством пропусков и аномалий; исследовал сложный характер взаимосвязей признаков со значением целевого признака; провёл объёмный исследовательский анализ с подробной визуализацией; использовал два подхода к прогнозу: прямой прогноз recovery и расчёт recovery на базе прогноза доли золота в концентрате и хвостах; сравнил ансамбль моделей для каждого этапа процесса с моделью, описывающей все этапы, выбрал оптимальный вариант; обучил несколько моделей (<code>Lasso, XGBoostRegressor, CatBoostRegressor</code>), использовал <code>sklearn pipeline </code>

**Результаты:**

Выявил линейный рост среднего значения доли золота в выходном концентрате от этапа к этапу. На диаграммах рассеяния также определяется влияние параметров процесса на данный признак. Доля серебра и свинца в выходном концентрате от этапа к этапу имеет тенденцию к снижению. Руда  содержит золото, серебро и свинец, причём наблюдается тенденция линейной связи долей этих металлов в сырье (т.е. состав руды в определённых  пределах постоянный). В хвостах больше всего серебра, а вот свинца и золота примерно одинаково. Возможно, из-за сложностей при разделении  данных металлов. Выделить какие-то явные взаимосвязи, кроме линейного роста доли золота в концентрате, на исследовательском этапе не удалось. В том числе из-за большого количества признаков.

При построении моделей машинного обучения рассмотрел два подхода к прогнозу: прямой прогноз recovery и расчёт recovery на базе прогноза доли золота в концентрате и хвостах. Прямой прогноз оказался более стабильным и с меньшим значением sMAPE на кросс валидации. Для работы выбрал прямой прогноз recovery.

В рамках машинного обучения рассмотрел несколько наборов моделей: `Lasso, XGBoostRegressor, CatBoostRegressor.` Использовал стандартизацию `StandardScaler` и заполнение пропусков `interpolate(method='time')`. Все эти этапы оформил как `Pipeline`. При подборе гиперпараметров пользовался кросс-валидацией и поиском по  сетке, в качестве метрик использовал собственные функции расчёта sMAPE.

Линейная модель <code>Lasso()</code> превзошла <code>XGBoostRegressor</code> и не уступила <code>CatBoostRegressor</code>. Визуализация результатов прогноза также  показала корректность работы <code>Lasso</code>. На тестовой выборке получено  значение `total_smape 6.475`. На константной модели - `7.238`. На мой взгляд, можно улучшить качество, выполнив feature engineering согласно деталям процесса обогащения. Для этого нужны дополнительные  данные.